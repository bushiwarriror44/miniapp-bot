{% extends "base.html" %}
{% block title %}Админ-панель{% endblock %}
{% block body %}
  <script>window.ADMIN_ROLE = "{{ role }}";</script>
  <main class="container">
    <header class="card" style="padding:14px 16px;display:flex;gap:12px;align-items:center;justify-content:space-between;">
      <div>
        <h1 style="margin:0;font-size:20px;">Управление данными TeleDoska</h1>
        <p class="muted" style="margin:4px 0 0 0;font-size:13px;">Управление KPI, главной страницей, биржей и гарантом.</p>
      </div>
      <a href="/admin/logout" class="btn" style="text-decoration:none;">Выйти</a>
    </header>

    <div class="layout" style="margin-top:12px;">
      <aside class="card sidebar">
        <button class="btn tab-btn active" data-tab-btn="home" data-admin-only>Главная страница</button>
        <button class="btn tab-btn" data-tab-btn="main-edit" data-admin-only>Изменение главной страницы</button>
        <button class="btn tab-btn" data-tab-btn="exchange" data-admin-only>Биржа</button>
        <button class="btn tab-btn" data-tab-btn="guarant" data-admin-only>Гарант</button>
        <button class="btn tab-btn" data-tab-btn="users" data-admin-only>Пользователи</button>
        <button class="btn tab-btn" data-tab-btn="labels" data-admin-only>Метки</button>
        <button class="btn tab-btn" data-tab-btn="rating" data-admin-only>Рейтинг</button>
        <button class="btn tab-btn" data-tab-btn="moderation">Модерация</button>
        <button class="btn tab-btn" data-tab-btn="moderators" data-admin-only>Модераторы</button>
        <button class="btn tab-btn" data-tab-btn="log" data-admin-only>Лог</button>
        <button class="btn tab-btn" data-tab-btn="support" data-admin-only>Обращения в поддержку</button>
        <button class="btn tab-btn" data-tab-btn="faq" data-admin-only>FAQ</button>
        <button class="btn tab-btn" data-tab-btn="extra" data-admin-only>Дополнительное</button>
        <button class="btn tab-btn" data-tab-btn="bot" data-admin-only>Бот</button>
      </aside>

      <section class="stack">
        <section id="tab-home" class="tab-view stack" data-admin-only>
          <div class="grid-2">
            <article class="card" style="padding:14px;">
              <p class="muted" style="margin:0 0 6px 0;">Количество пользователей</p>
              <h2 id="kpiUsersCount" style="margin:0;font-size:30px;">0</h2>
            </article>
            <article class="card" style="padding:14px;">
              <p class="muted" style="margin:0 0 6px 0;">Суммарно активных объявлений</p>
              <h2 id="kpiActiveAdsTotal" style="margin:0;font-size:30px;">0</h2>
            </article>
          </div>
          <div class="card" style="padding:12px;display:flex;justify-content:space-between;align-items:center;">
            <span class="muted" id="kpiUpdatedAt">Обновлено: -</span>
            <button id="refreshKpiBtn" class="btn">Обновить KPI</button>
          </div>
        </section>

        <section id="tab-main-edit" class="tab-view stack" style="display:none;" data-admin-only>
          <div class="card" style="padding:12px;">
            <h2 style="margin:0 0 10px 0;font-size:16px;">Ссылка кнопки новостей</h2>
            <div class="grid-2">
              <input id="newsChannelUrlInput" class="input" placeholder="https://t.me/..." />
              <button id="saveMainPageBtn" class="btn btn-primary">Сохранить изменения главной</button>
            </div>
          </div>
          <div class="card" style="padding:12px;">
            <div style="display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap;">
              <h2 style="margin:0;font-size:16px;">Горячие предложения</h2>
              <div style="display:flex;gap:8px;">
                <button id="addHotOfferBtn" class="btn">Добавить предложение</button>
                <button id="attachAdToHotOfferBtn" class="btn">Привязать объявление</button>
              </div>
            </div>
            <div id="hotOffersTableWrap" style="margin-top:10px;overflow:auto;"></div>
          </div>
        </section>

        <section id="tab-exchange" class="tab-view stack" style="display:none;" data-admin-only>
          <section class="card" style="padding:12px;">
            <div style="display:grid;grid-template-columns:1fr auto;gap:8px;">
              <input id="userSearchInput" class="input" placeholder="Поиск по пользователям (username / usernameLink)" />
              <button id="userSearchBtn" class="btn">Искать</button>
            </div>
            <div id="userSearchResults" style="margin-top:10px;"></div>
          </section>

          <section class="card" style="padding:12px;">
            <h2 style="margin:0 0 8px 0;font-size:16px;">Категории биржи</h2>
            <div id="categoriesList" style="display:flex;flex-wrap:wrap;gap:8px;"></div>
          </section>

          <section class="card" style="padding:12px;">
            <div style="display:flex;flex-wrap:wrap;gap:8px;align-items:center;justify-content:space-between;">
              <h2 id="editorTitle" style="margin:0;font-size:16px;">Выберите категорию</h2>
              <div style="display:flex;gap:8px;">
                <button id="addItemBtn" class="btn">Добавить элемент</button>
                <button id="addAdBtn" class="btn btn-primary" style="display:none;">Добавить объявление вручную</button>
              </div>
            </div>
            <div id="itemsTableWrap" style="margin-top:10px;overflow:auto;"></div>
          </section>
        </section>

        <section id="tab-guarant" class="tab-view stack" style="display:none;" data-admin-only>
          <section class="card" style="padding:12px;">
            <h2 style="margin:0 0 10px 0;font-size:16px;">Ссылка на гаранта</h2>
            <div class="grid-2">
              <input id="guarantProfileLinkInput" class="input" placeholder="https://t.me/..." />
              <input id="guarantDisplayNameInput" class="input" placeholder="Отображаемое имя гаранта" />
            </div>
            <input id="guarantUsernameInput" class="input" style="margin-top:8px;" placeholder="username гаранта" />
          </section>
          <section class="card" style="padding:12px;">
            <h2 style="margin:0 0 10px 0;font-size:16px;">Условия гаранта</h2>
            <textarea id="guarantAboutTextInput" class="textarea" style="min-height:100px;" placeholder="Описание"></textarea>
            <p class="muted" style="margin:10px 0 6px 0;">Каждое условие с новой строки</p>
            <textarea id="guarantConditionsInput" class="textarea" style="min-height:150px;" placeholder="Условие 1&#10;Условие 2"></textarea>
            <button id="saveGuarantBtn" class="btn btn-primary" style="margin-top:10px;">Сохранить настройки гаранта</button>
          </section>
        </section>

        <section id="tab-users" class="tab-view stack" style="display:none;" data-admin-only>
          <section class="card" style="padding:12px;">
            <div style="display:grid;grid-template-columns:1fr auto;gap:8px;">
              <input id="adminUsersSearchInput" class="input" placeholder="Поиск по username или telegramId" />
              <button id="adminUsersSearchBtn" class="btn">Найти пользователей</button>
            </div>
            <div id="adminUsersTableWrap" style="margin-top:10px;"></div>
          </section>
          <section class="card" style="padding:12px;">
            <h2 style="margin:0 0 8px 0;font-size:16px;">Карточка пользователя</h2>
            <div id="adminUserDetailsWrap" class="muted">Выберите пользователя в таблице выше.</div>
          </section>
        </section>

        <section id="tab-labels" class="tab-view stack" style="display:none;" data-admin-only>
          <section class="card" style="padding:12px;">
            <h2 style="margin:0 0 8px 0;font-size:16px;">Управление метками</h2>
            <div id="adminLabelsListWrap"></div>
            <div style="margin-top:12px;">
              <input id="adminNewLabelNameInput" class="input" placeholder="Название метки" />
              <input
                id="adminNewLabelColorInput"
                type="color"
                class="input"
                style="width:80px;margin-left:8px;"
                value="#0070f3"
              />
              <button id="adminCreateLabelBtn" class="btn" style="margin-left:8px;">Создать метку</button>
            </div>
          </section>
        </section>

        <section id="tab-rating" class="tab-view stack" style="display:none;" data-admin-only>
          <section class="card" style="padding:12px;">
            <div style="display:grid;grid-template-columns:1fr auto;gap:8px;margin-bottom:10px;">
              <input id="ratingUsersSearchInput" class="input" placeholder="Поиск по username или telegramId (необязательно)" />
              <button id="ratingUsersRefreshBtn" class="btn">Обновить</button>
            </div>
            <div id="ratingUsersTableWrap" style="overflow:auto;"></div>
          </section>
        </section>

        <section id="tab-moderation" class="tab-view stack" style="display:none;">
          <section class="card" style="padding:12px;">
            <div class="grid-2">
              <div>
                <label class="muted" style="display:block;margin-bottom:4px;">Статус заявок</label>
                <select id="moderationStatusFilter" class="select">
                  <option value="pending">pending</option>
                  <option value="approved">approved</option>
                  <option value="rejected">rejected</option>
                </select>
              </div>
              <div style="display:flex;align-items:end;">
                <button id="moderationRefreshBtn" class="btn">Обновить</button>
              </div>
            </div>
            <div id="moderationRequestsTableWrap" style="margin-top:10px;"></div>
          </section>
          <section class="card" style="padding:12px;">
            <h2 style="margin:0 0 8px 0;font-size:16px;">Карточка заявки</h2>
            <div id="moderationRequestDetailsWrap" class="muted">Выберите заявку в таблице выше.</div>
          </section>
        </section>

        <section id="tab-moderators" class="tab-view stack" style="display:none;" data-admin-only>
          <section class="card" style="padding:12px;">
            <h2 style="margin:0 0 10px 0;font-size:16px;">Модераторы</h2>
            <p class="muted" style="margin:4px 0 10px 0;font-size:13px;">Создайте пароли для входа модераторов. Подпись отображается в логе действий.</p>
            <div style="display:grid;grid-template-columns:1fr 1fr auto;gap:8px;align-items:end;margin-bottom:12px;">
              <div>
                <label class="muted" style="display:block;font-size:12px;margin-bottom:4px;">Пароль</label>
                <input id="newModeratorPasswordInput" class="input" type="password" placeholder="••••••••" />
              </div>
              <div>
                <label class="muted" style="display:block;font-size:12px;margin-bottom:4px;">Подпись (для лога)</label>
                <input id="newModeratorLabelInput" class="input" placeholder="Модератор 1" />
              </div>
              <button id="createModeratorBtn" class="btn btn-primary">Создать</button>
            </div>
            <div id="moderatorsTableWrap" style="overflow:auto;"></div>
          </section>
          <section class="card" style="padding:12px;">
            <h3 style="margin:0 0 8px 0;font-size:14px;">Изменить модератора</h3>
            <div id="editModeratorWrap" class="muted" style="font-size:13px;">Выберите модератора в таблице и нажмите «Изменить».</div>
            <div id="editModeratorFormWrap" style="display:none;margin-top:10px;">
              <input id="editModeratorIdInput" type="hidden" />
              <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;">
                <div>
                  <label class="muted" style="display:block;font-size:12px;margin-bottom:4px;">Новый пароль (оставьте пустым, чтобы не менять)</label>
                  <input id="editModeratorPasswordInput" class="input" type="password" placeholder="••••••••" />
                </div>
                <div>
                  <label class="muted" style="display:block;font-size:12px;margin-bottom:4px;">Подпись</label>
                  <input id="editModeratorLabelInput" class="input" placeholder="Подпись" />
                </div>
              </div>
              <div style="margin-top:8px;display:flex;gap:8px;">
                <button id="saveModeratorBtn" class="btn btn-primary">Сохранить</button>
                <button id="cancelEditModeratorBtn" class="btn">Отмена</button>
              </div>
            </div>
          </section>
        </section>

        <section id="tab-log" class="tab-view stack" style="display:none;" data-admin-only>
          <section class="card" style="padding:12px;">
            <h2 style="margin:0 0 8px 0;font-size:16px;">Лог действий модераторов</h2>
            <div style="margin-bottom:8px;">
              <button id="refreshLogBtn" class="btn">Обновить</button>
            </div>
            <div id="logTableWrap" style="overflow:auto;"></div>
          </section>
        </section>

        <section id="tab-support" class="tab-view stack" style="display:none;" data-admin-only>
          <section class="card" style="padding:12px;">
            <h2 style="margin:0 0 8px 0;font-size:16px;">Обращения в поддержку</h2>
            <div style="margin-bottom:8px;">
              <button id="refreshSupportBtn" class="btn">Обновить</button>
            </div>
            <div id="supportRequestsTableWrap" style="overflow:auto;"></div>
          </section>
        </section>

        <section id="tab-faq" class="tab-view stack" style="display:none;" data-admin-only>
          <section class="card" style="padding:12px;">
            <div style="display:flex;justify-content:space-between;align-items:center;gap:8px;">
              <h2 style="margin:0;font-size:16px;">Частые вопросы</h2>
              <button id="addFaqBtn" class="btn">Добавить вопрос</button>
            </div>
            <div id="faqTableWrap" style="margin-top:10px;"></div>
          </section>
          <section class="card" style="padding:12px;">
            <h2 style="margin:0 0 8px 0;font-size:16px;">Редактор FAQ</h2>
            <input id="faqIdInput" class="input" placeholder="id (например how-to-buy)" />
            <input id="faqTitleInput" class="input" placeholder="Заголовок вопроса" style="margin-top:8px;" />
            <textarea id="faqTextInput" class="textarea" style="min-height:120px;margin-top:8px;" placeholder="Текст ответа"></textarea>
            <div style="margin-top:10px;display:flex;justify-content:flex-end;gap:8px;">
              <button id="faqResetBtn" class="btn">Очистить</button>
              <button id="saveFaqBtn" class="btn btn-primary">Сохранить FAQ</button>
            </div>
          </section>
        </section>

        <section id="tab-extra" class="tab-view stack" style="display:none;" data-admin-only>
          <section class="card" style="padding:12px;">
            <h2 style="margin:0 0 8px 0;font-size:16px;">Дополнительное</h2>
            <p class="muted" style="margin:4px 0 12px 0;font-size:13px;">Типы вакансий и валюты оплаты для раздела «Вакансии» на бирже.</p>
            <h3 style="margin:12px 0 8px 0;font-size:14px;">Вакансии (типы работ)</h3>
            <div style="margin-bottom:8px;">
              <button id="addJobTypeBtn" class="btn">Добавить</button>
            </div>
            <div id="jobTypesTableWrap" style="overflow:auto;"></div>
            <h3 style="margin:16px 0 8px 0;font-size:14px;">Валюта оплаты</h3>
            <div style="margin-bottom:8px;">
              <button id="addCurrencyBtn" class="btn">Добавить</button>
            </div>
            <div id="currenciesTableWrap" style="overflow:auto;"></div>
            <div style="margin-top:12px;">
              <button id="saveExchangeOptionsBtn" class="btn btn-primary">Сохранить</button>
            </div>
          </section>
        </section>

        <section id="tab-bot" class="tab-view stack" style="display:none;" data-admin-only>
          <section class="card" style="padding:12px;">
            <h2 style="margin:0 0 8px 0;font-size:16px;">Приветствие в боте (/start)</h2>
            <label class="muted" style="display:block;margin-bottom:6px;">Текст приветствия</label>
            <textarea id="botWelcomeMessageInput" class="textarea" style="min-height:120px;" placeholder="Приветственное сообщение для пользователя"></textarea>
            <label class="muted" style="display:block;margin:10px 0 6px 0;">Ссылка поддержки (для заблокированных пользователей)</label>
            <input id="botSupportLinkInput" class="input" placeholder="https://t.me/support_username" />
            <div style="margin-top:10px;">
              <label class="muted" style="display:block;margin-bottom:6px;">Фотография приветствия</label>
              <input id="botWelcomePhotoInput" type="file" accept="image/png,image/jpeg,image/webp" />
              <div id="botWelcomePhotoPreviewWrap" style="margin-top:8px;"></div>
            </div>
            <div style="margin-top:10px;display:flex;justify-content:flex-end;gap:8px;">
              <button id="uploadBotPhotoBtn" class="btn">Загрузить фото</button>
              <button id="saveBotConfigBtn" class="btn btn-primary">Сохранить настройки бота</button>
            </div>
          </section>

          <section class="card" style="padding:12px;">
            <h2 style="margin:0 0 8px 0;font-size:16px;">Отправка сообщений через бота</h2>
            <div class="grid-2">
              <input id="botMessageTelegramIdInput" class="input" placeholder="Telegram ID пользователя (если не рассылка)" />
              <label style="display:flex;align-items:center;gap:8px;">
                <input id="botMessageSendAllInput" type="checkbox" />
                Отправить всем пользователям из базы
              </label>
            </div>
            <textarea id="botMessageTextInput" class="textarea" style="min-height:120px;margin-top:8px;" placeholder="Текст сообщения"></textarea>
            <div id="botMessagePhotoDropZone" style="margin-top:10px;padding:20px;border:2px dashed var(--border-color, #ddd);border-radius:8px;text-align:center;cursor:pointer;transition:background-color 0.2s, border-color 0.2s;" onmouseover="this.style.backgroundColor='var(--color-surface, #f5f5f5)';" onmouseout="this.style.backgroundColor='';">
              <input id="botMessagePhotoInput" type="file" accept="image/*" style="display:none;" />
              <p class="muted" style="margin:0 0 8px 0;font-size:13px;">Перетащите изображение сюда или</p>
              <button type="button" class="btn" onclick="document.getElementById('botMessagePhotoInput').click();">Выбрать файл</button>
            </div>
            <div id="botMessagePhotoPreviewWrap" style="margin-top:10px;display:none;">
              <div style="position:relative;display:inline-block;">
                <img id="botMessagePhotoPreviewImg" src="" alt="Preview" style="max-width:300px;max-height:300px;border-radius:8px;border:1px solid var(--border-color, #ddd);" />
                <button id="botMessagePhotoRemoveBtn" type="button" class="btn" style="position:absolute;top:8px;right:8px;background-color:rgba(0,0,0,0.6);color:white;border:none;padding:4px 8px;font-size:12px;">✕</button>
              </div>
            </div>
            <div style="margin-top:10px;display:flex;justify-content:flex-end;">
              <button id="sendBotMessageBtn" class="btn btn-primary">Отправить в бота</button>
            </div>
            <div id="botMessageResult" class="muted" style="margin-top:8px;"></div>
          </section>
        </section>
      </section>
    </div>
  </main>

  <dialog id="hotOfferModal" class="card" style="border:none;max-width:620px;width:calc(100% - 24px);padding:12px;">
    <h3 id="hotOfferModalTitle" style="margin:0 0 10px 0;">Горячее предложение</h3>
    <div class="stack">
      <input id="hotOfferTitleInput" class="input" placeholder="Заголовок" />
      <input id="hotOfferPriceInput" class="input" placeholder="Цена (например 97 250)" />
      <input id="hotOfferSubtitleInput" class="input" placeholder="Подзаголовок" />
    </div>
    <div style="margin-top:10px;display:flex;justify-content:flex-end;gap:8px;">
      <button id="hotOfferCancelBtn" class="btn" type="button">Отмена</button>
      <button id="hotOfferSaveBtn" class="btn btn-primary" type="button">Сохранить</button>
    </div>
  </dialog>

  <dialog id="attachAdHotOfferModal" class="card" style="border:none;max-width:620px;width:calc(100% - 24px);padding:12px;">
    <h3 style="margin:0 0 10px 0;">Выбор объявления для горячего предложения</h3>
    <p class="muted" style="margin:0 0 10px 0;font-size:13px;">Выберите категорию и объявление. Оно появится в блоке «Горячие предложения» и по клику будет вести на Биржу.</p>
    <div style="margin-bottom:10px;">
      <label class="muted" style="display:block;font-size:12px;margin-bottom:4px;">Категория</label>
      <select id="attachAdCategorySelect" class="select" style="width:100%;">
        <option value="ads">Продам рекламу</option>
        <option value="buyAds">Куплю рекламу</option>
        <option value="jobs">Вакансии</option>
        <option value="services">Услуги</option>
        <option value="currency">Обмен валют</option>
        <option value="sellChannels">Продам канал</option>
        <option value="buyChannels">Куплю канал</option>
        <option value="other">Прочее</option>
      </select>
    </div>
    <div id="attachAdItemsListWrap" style="max-height:280px;overflow:auto;border:1px solid var(--border-color, #ddd);border-radius:6px;padding:8px;">
      <p class="muted" style="margin:0;font-size:13px;">Выберите категорию</p>
    </div>
    <div style="margin-top:10px;display:flex;justify-content:flex-end;gap:8px;">
      <button id="attachAdHotOfferCloseBtn" class="btn" type="button">Закрыть</button>
    </div>
  </dialog>

  <dialog id="ratingEditModal" class="card" style="border:none;max-width:500px;width:calc(100% - 24px);padding:12px;">
    <h3 style="margin:0 0 10px 0;">Изменение рейтинга</h3>
    <p class="muted" style="margin:0 0 10px 0;font-size:13px;">Ручная корректировка рейтинга. Итоговый рейтинг = авто-рейтинг + ручная корректировка.</p>
    <div class="stack">
      <div>
        <label class="muted" style="display:block;font-size:12px;margin-bottom:4px;">Ручная корректировка</label>
        <input id="ratingManualDeltaInput" class="input" type="number" step="0.1" placeholder="0.0" />
      </div>
      <p class="muted" style="margin:0;font-size:12px;" id="ratingInfoText">Авто-рейтинг: —, Итоговый: —</p>
    </div>
    <div style="margin-top:10px;display:flex;justify-content:flex-end;gap:8px;">
      <button id="ratingEditCancelBtn" class="btn" type="button">Отмена</button>
      <button id="ratingEditSaveBtn" class="btn btn-primary" type="button">Сохранить</button>
    </div>
  </dialog>

  <dialog id="itemModal" class="card" style="border:none;max-width:980px;width:calc(100% - 24px);padding:12px;">
    <h3 id="itemModalTitle" style="margin:0 0 4px 0;">Элемент</h3>
    <div class="modal-toggle-row">
      <p class="muted" style="margin:0;font-size:13px;">Редактирование через форму полей (без JSON).</p>
      <button id="toggleAdvancedEditBtn" class="btn" type="button" style="display:none;">Показать расширенное отображение</button>
    </div>

    <section id="simpleAdEditor" style="display:none;">
      <div class="simple-form-grid">
        <div class="simple-form-row">
          <label class="simple-form-label" for="simpleAdTheme">Тема/заголовок</label>
          <input id="simpleAdTheme" class="input" placeholder="криптовалюты, трейдинг" />
        </div>
        <div class="simple-form-row">
          <label class="simple-form-label" for="simpleAdPrice">Цена</label>
          <input id="simpleAdPrice" class="input" type="number" placeholder="1500" />
        </div>
        <div class="simple-form-row">
          <label class="simple-form-label" for="simpleAdDescription">Текст объявления</label>
          <textarea id="simpleAdDescription" class="textarea" style="min-height:100px;" placeholder="Описание объявления"></textarea>
        </div>
        <div class="simple-form-row">
          <label class="simple-form-label" for="simpleAdUsername">Username</label>
          <input id="simpleAdUsername" class="input" placeholder="crypto_seller" />
        </div>
        <div class="simple-form-row">
          <label class="simple-form-label" for="simpleAdChannelLink">Ссылка канала/чата</label>
          <input id="simpleAdChannelLink" class="input" placeholder="https://t.me/..." />
        </div>
        <div class="simple-form-row">
          <label class="simple-form-label" for="simpleAdType">Тип объявления</label>
          <select id="simpleAdType" class="select">
            <option value="post_in_channel">post_in_channel</option>
            <option value="post_in_chat">post_in_chat</option>
          </select>
        </div>
        <div class="simple-form-row">
          <label class="simple-form-label" for="simpleAdPayment">Метод оплаты</label>
          <select id="simpleAdPayment" class="select">
            <option value="crypto">crypto</option>
            <option value="card">card</option>
          </select>
        </div>
        <div class="simple-form-row">
          <label class="simple-form-label" for="simpleAdPublishTime">Время публикации</label>
          <input id="simpleAdPublishTime" class="input" placeholder="вечер" />
        </div>
        <div class="simple-form-row">
          <label class="simple-form-label" for="simpleAdPostDuration">Длительность</label>
          <input id="simpleAdPostDuration" class="input" placeholder="1 час топа и 24 часа в ленте" />
        </div>
        <div class="simple-form-row">
          <span class="simple-form-label">Параметры</span>
          <div style="display:flex;flex-wrap:wrap;gap:12px;">
            <label style="display:flex;gap:8px;align-items:center;"><input id="simpleAdVerified" type="checkbox" /> verified</label>
            <label style="display:flex;gap:8px;align-items:center;"><input id="simpleAdPinned" type="checkbox" /> pinned</label>
            <label style="display:flex;gap:8px;align-items:center;"><input id="simpleAdUnderGuarantee" type="checkbox" /> underGuarantee</label>
          </div>
        </div>
      </div>
    </section>

    <section id="advancedEditorSection">
      <div id="fieldRows" style="display:flex;flex-direction:column;gap:8px;"></div>
      <button id="addFieldBtn" class="btn" type="button" style="margin-top:10px;">Добавить поле</button>
    </section>
    <div style="margin-top:10px;display:flex;justify-content:flex-end;gap:8px;">
      <button id="itemCancelBtn" class="btn" type="button">Отмена</button>
      <button id="itemSaveBtn" class="btn btn-primary" type="button">Сохранить</button>
    </div>
    <div id="itemModalFallbackNote" class="modal-fallback-note">
      Если модальное окно отображается некорректно, проверьте поддержку тега dialog в браузере.
    </div>
  </dialog>

  <dialog id="adModal" class="card" style="border:none;max-width:700px;width:calc(100% - 24px);padding:12px;">
    <h3 style="margin:0 0 10px 0;">Добавить объявление (ads)</h3>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;">
      <input id="adUsername" class="input" placeholder="username" />
      <input id="adChannelLink" class="input" placeholder="https://t.me/..." />
      <input id="adPrice" class="input" type="number" placeholder="price" />
      <input id="adTheme" class="input" placeholder="theme" />
      <select id="adType" class="select">
        <option value="post_in_channel">post_in_channel</option>
        <option value="post_in_chat">post_in_chat</option>
      </select>
      <select id="adPayment" class="select">
        <option value="crypto">crypto</option>
        <option value="card">card</option>
      </select>
      <input id="adPublishTime" class="input" placeholder="publishTime (например: вечер)" />
      <input id="adPostDuration" class="input" placeholder="postDuration" />
      <label style="display:flex;gap:8px;align-items:center;"><input id="adVerified" type="checkbox" /> verified</label>
      <label style="display:flex;gap:8px;align-items:center;"><input id="adPinned" type="checkbox" /> pinned</label>
      <label style="display:flex;gap:8px;align-items:center;"><input id="adGuarantee" type="checkbox" /> underGuarantee</label>
    </div>
    <textarea id="adDescription" class="textarea" style="min-height:120px;margin-top:8px;" placeholder="description"></textarea>
    <div style="margin-top:10px;display:flex;justify-content:flex-end;gap:8px;">
      <button id="adCancelBtn" class="btn" type="button">Отмена</button>
      <button id="adSaveBtn" class="btn btn-primary" type="button">Сохранить объявление</button>
    </div>
    <div id="adModalFallbackNote" class="modal-fallback-note">
      Если модальное окно не открылось штатно, включен fallback-режим отображения.
    </div>
  </dialog>

  <script src="/admin-static/js/admin-panel.js"></script>
{% endblock %}
